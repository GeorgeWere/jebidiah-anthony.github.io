<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    
    
    <meta property="article:tag" content="windows" />
    
    <meta property="article:tag" content="event manager" />
    
    <meta property="article:tag" content="event viewer" />
    
    <meta property="article:tag" content="event logs" />
    
    <meta property="article:tag" content="windows logs" />
    
    <meta property="article:tag" content="logs" />
    
    <meta property="article:tag" content="evtx" />
    
    <meta property="article:tag" content="evtx logs" />
    
    <meta property="article:tag" content="custom evtx" />
    
    <meta property="article:tag" content="creating" />
    
    <meta property="article:tag" content="creation" />
    
    <meta property="article:tag" content="manifest file" />
    
    <meta property="article:tag" content="ecmangen.exe" />
    
    <meta property="article:tag" content="ecmangen" />
        

    
    <meta property="og:image" content="http://localhost:4000/banner.jpg" />
    

    
    <meta property="og:title" content="Custom evtx Logfiles" />
    

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Custom evtx Logfiles | jebidiah-anthony</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Custom evtx Logfiles" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This shows the process of how to create custom .evtx log files using ecmangen.exe and other utilities present in the Windows Development Kit. The log file(s) created could be used as a destination log for forwarded events." />
<meta property="og:description" content="This shows the process of how to create custom .evtx log files using ecmangen.exe and other utilities present in the Windows Development Kit. The log file(s) created could be used as a destination log for forwarded events." />
<link rel="canonical" href="http://localhost:4000/prjct/Custom-evtx-Logfiles.html" />
<meta property="og:url" content="http://localhost:4000/prjct/Custom-evtx-Logfiles.html" />
<meta property="og:site_name" content="jebidiah-anthony" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Custom evtx Logfiles","url":"http://localhost:4000/prjct/Custom-evtx-Logfiles.html","description":"This shows the process of how to create custom .evtx log files using ecmangen.exe and other utilities present in the Windows Development Kit. The log file(s) created could be used as a destination log for forwarded events.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <style>
      header {
	margin-bottom: 0px;
      }
      .container {
	max-width: 1200px;
      }
      .sidebar {
        border-right: 1px dashed #b5e853;
	bottom: 0;
        /*height: 100%; */
	overflow: auto;
	padding: 10px 10px 10px 10px;
        position: fixed;
	top: 0;
        width: 230px;
      }
      
      .ctf_content {
        margin-left: 250px;
	padding-bottom: 5px;
      }
      .ctf_content h2 {	padding: 20px 0px 0px 10px; }
      .ctf_content h3 { margin: 20px 0px 0px 10px; }
      .ctf_content img {
	max-width: 100%;
	padding: 0 10px 0 0;
      }
      .ctf_content table { padding: 0 15px; }

      #main_content h1 { padding: 20px 0px 0px 8px; }
      #main_content h2, p, pre { 
	padding-right:10px;
	padding-left:15px; 
      }
      #main_content h4 { 
        margin: 20px 0px 10px 0px; 
      }

      #main_content h4 { padding-left: 25px; }
      #main_content ol, ul { margin: 0 0 0 10px; }

      .highlighter-rouge { padding: 0 10px 0 15px; }

      .section-divider{
        border-bottom: 1.5px solid #b5e853;
        padding-top:28px;
        width:55%;
      }
      
      @media screen and (max-height: 450px) {}
    </style>

  </head>

  <body>
    <div class="container">
       <div class="sidebar">
	 <div><h2 style="margin-bottom:0; padding-top:20px">[SITE PAGES]</h2>

<div style="padding-top:10px">
  
  > <a href="/">whoami</a>
  
</div>
<div style="padding-top:10px">  
  >  <a href="/htb.html">
    
    htb writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/ctf.html">
    
    ctf writeups
    
  </a>
</div>
<div style="padding-top:10px">
  > <a href="/projects.html">
    
    <strong style="color:orange">projects</strong>
    
  </a>
</div>
</div>
	 <div style="padding-bottom:20px">
           
             <h2 style="margin-bottom:0; padding-top: 20px">[PROJECTS]</h2>


<div style="padding-top:10px">
  
  > <a href="http://localhost:4000/prjct/CORS.html">CORS</a>
  
</div>

<div style="padding-top:10px">
  
  > <a href="http://localhost:4000/prjct/elastalerter.html">elastalerter.py</a>
  
</div>

<div style="padding-top:10px">
  
  > <a href="http://localhost:4000/prjct/Windows-Event-Collector.html">Event Forwarder</a>
  
</div>

<div style="padding-top:10px">
  
  > <strong style="color:orange">Custom .evtx Files</strong>
  
</div>

<div style="padding-top:10px">
  
  > <a href="http://localhost:4000/prjct/PTT-PSRemoting.html">Double Hop Bypass</a>
  
</div>



	   
	 </div>
       </div>
       <div class="ctf_content">
	 <header>
           <div class="container">
             <h1 style="padding:10px 0 0 20px">jebidiah-anthony</h1>
             <h2 style="padding:0 0 0 20px">write-ups and what not</h2>
           </div>
         </header>
         <section id="main_content"><h1 id="creating-custom-logs-for-windows-event-collector"><span style="color:red">CREATING <strong>CUSTOM LOGS</strong> FOR <strong>WINDOWS EVENT COLLECTOR</strong></span></h1>

<hr />

<h2 id="environment">ENVIRONMENT</h2>

<table>
  <thead>
    <tr>
      <th>WINDOWS</th>
      <th>OS</th>
      <th>BUILD No.</th>
      <th>REMARKS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>WIN-BO2CT95INDP</td>
      <td>Windows Server 2016 Standard</td>
      <td>10.0.14393 Build 14393</td>
      <td>Collector Machine</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="applicationstools-used">APPLICATIONS/TOOLS USED</h2>

<ol>
  <li>Windows SDK (Development Kit):
    <ul>
      <li>ecmangen.exe</li>
      <li>mc.exe (Message Compiler)</li>
      <li>rc.exe (Resource Compiler)</li>
    </ul>
  </li>
  <li>csc.exe (C# Compiler)</li>
  <li>wevtutil</li>
</ol>

<p><strong>NOTE(S)</strong>:</p>
<ul>
  <li><strong>ecmangen.exe</strong> was removed from the Windows 10 SDK starting from 10.0.16299.15
    <ul>
      <li>Parallel installations of Windows SDK are allowed.</li>
      <li>In this case, <a href="https://go.microsoft.com/fwlink/p/?LinkId=838916">Windows 10 SDK (10.0.14393.795)</a> was installed alongside the latest SDK version.</li>
    </ul>
  </li>
  <li><strong>csc.exe</strong> is included in the <strong><em>Microsoft .NET Framework</em></strong>.
    <ul>
      <li><strong>.NET Framework</strong> is native to Windows Operating Systems.</li>
      <li>The Framework’s version depends on the OS installed.</li>
    </ul>
  </li>
  <li><strong>wevtutil</strong> is a command native to the <strong><em>Command Prompt</em></strong></li>
</ul>

<hr />

<h2 id="procedure">PROCEDURE</h2>

<ol>
  <li>Create a manifest file:
    <ol>
      <li>
        <p>Open <code class="highlighter-rouge">ecmangen.exe</code>:</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Program Files (x86)\Windows Kits\10\bin\x64\ecmangen.exe
</code></pre></div>        </div>
      </li>
      <li>
        <p>Create a new <strong><em>provider</em></strong>:</p>

        <ol>
          <li>On the left panel, right click on <code class="highlighter-rouge">Events Section</code> then select <strong>New</strong> -&gt; <strong>Provider</strong>.</li>
          <li>
            <p>Fill up the following fields:</p>

            <table>
              <thead>
                <tr>
                  <th>FIELD</th>
                  <th>VALUE</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Name</td>
                  <td><code class="highlighter-rouge">WEF-Events</code></td>
                </tr>
                <tr>
                  <td>Symbol</td>
                  <td><code class="highlighter-rouge">WEF_Events</code></td>
                </tr>
                <tr>
                  <td>GUID</td>
                  <td>Press <code class="highlighter-rouge">New</code> beside the input field</td>
                </tr>
                <tr>
                  <td>Resources</td>
                  <td><code class="highlighter-rouge">C:\Windows\System32\WEF-Events.dll</code></td>
                </tr>
                <tr>
                  <td>Messages</td>
                  <td><code class="highlighter-rouge">C:\Windows\System32\WEF-Events.dll</code></td>
                </tr>
              </tbody>
            </table>
          </li>
          <li>On the right panel, click on <code class="highlighter-rouge">Save</code>.</li>
        </ol>
      </li>
      <li>
        <p>Create a new <strong><em>template</em></strong>:</p>

        <ol>
          <li>On the left panel, under <code class="highlighter-rouge">WEF-Events</code>, select <code class="highlighter-rouge">Templates</code>.</li>
          <li>On the right panel, select <code class="highlighter-rouge">New Template</code>.</li>
          <li>
            <p>Fill up the following fields:</p>

            <table>
              <thead>
                <tr>
                  <th>FIELD</th>
                  <th>VALUE</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Name</td>
                  <td><code class="highlighter-rouge">WEF-Template</code></td>
                </tr>
              </tbody>
            </table>
          </li>
          <li>
            <p>Add <code class="highlighter-rouge">Field Attributes</code>:</p>

            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>InType</th>
                  <th>OutType</th>
                  <th>Count</th>
                  <th>Length</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Unicode</td>
                  <td>win:UnicodeString</td>
                  <td>xs:string</td>
                  <td>default</td>
                  <td>default</td>
                </tr>
                <tr>
                  <td>UInt32</td>
                  <td>win:UInt32</td>
                  <td>xs:unsignedInt</td>
                  <td>default</td>
                  <td>-</td>
                </tr>
              </tbody>
            </table>
          </li>
          <li>On the right panel, click <code class="highlighter-rouge">Save</code>.</li>
        </ol>
      </li>
      <li>
        <p>Create <strong><em>channels</em></strong> (maximum of 8):</p>

        <ol>
          <li>On the left panel, under <code class="highlighter-rouge">WEF-Events</code>, select <code class="highlighter-rouge">Channels</code>.</li>
          <li>On the right panel, select <code class="highlighter-rouge">New Channel</code>.</li>
          <li>
            <p>Fill up the following fields:</p>

            <table>
              <thead>
                <tr>
                  <th>NAME</th>
                  <th>SYMBOL</th>
                  <th>TYPE</th>
                  <th>ENABLE</th>
                  <th>DESCRIPTION</th>
                  <th>CHANNEL SECURITY</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>WEF-Security</td>
                  <td>WEF_Security</td>
                  <td>Operational</td>
                  <td>Yes</td>
                  <td>DC Security Logs</td>
                  <td>Default</td>
                </tr>
                <tr>
                  <td>WEF-System</td>
                  <td>WEF_System</td>
                  <td>Operational</td>
                  <td>Yes</td>
                  <td>DC System Logs</td>
                  <td>Default</td>
                </tr>
                <tr>
                  <td>WEF-PowerShell</td>
                  <td>WEF_PowerShell</td>
                  <td>Operational</td>
                  <td>Yes</td>
                  <td>DC PowerShell Logs</td>
                  <td>Default</td>
                </tr>
                <tr>
                  <td>WEF-Sysmon</td>
                  <td>WEF_Sysmon</td>
                  <td>Operational</td>
                  <td>Yes</td>
                  <td>DC Sysmon Logs</td>
                  <td>Default</td>
                </tr>
              </tbody>
            </table>
          </li>
          <li>On the right panel, click <code class="highlighter-rouge">Save</code>.</li>
        </ol>
      </li>
      <li>
        <p>Create a new <strong><em>event</em></strong>:</p>

        <ol>
          <li>On the left panel, under <code class="highlighter-rouge">WEF-Events</code>, select <code class="highlighter-rouge">Events</code>.</li>
          <li>On the right panel, select <code class="highlighter-rouge">New Event</code>.</li>
          <li>
            <p>Fill up the following fields:</p>

            <table>
              <thead>
                <tr>
                  <th>FIELD</th>
                  <th>VALUE</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Symbol</td>
                  <td><code class="highlighter-rouge">WEF_Event</code></td>
                </tr>
                <tr>
                  <td>Event ID</td>
                  <td><code class="highlighter-rouge">6969</code></td>
                </tr>
                <tr>
                  <td>Message</td>
                  <td><code class="highlighter-rouge">$(string.WEF-Events.event.6969.message)</code></td>
                </tr>
                <tr>
                  <td>Channel</td>
                  <td><code class="highlighter-rouge">WEF-Security</code></td>
                </tr>
                <tr>
                  <td>Template</td>
                  <td><code class="highlighter-rouge">WEF-Template</code></td>
                </tr>
                <tr>
                  <td>Keywords</td>
                  <td><code class="highlighter-rouge">win:AuditSuccess</code>, <code class="highlighter-rouge">win:AuditFailure</code></td>
                </tr>
              </tbody>
            </table>
          </li>
          <li>On the right panel, click on <code class="highlighter-rouge">Save</code>.</li>
        </ol>
      </li>
      <li>
        <p>Save the manifest file as “WEF_Events.man”</p>

        <p><strong>NOTE(S)</strong>:</p>
        <ul>
          <li>Avoid using the character, ‘<code class="highlighter-rouge">-</code>’, in the filename.
            <ul>
              <li>The generated C# file during compiling will face an error.</li>
            </ul>
          </li>
          <li>
            <p>Resulting manifest file (XML formatted):</p>

            <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="nt">&lt;instrumentationManifest</span> <span class="na">xsi:schemaLocation=</span><span class="s">"http://schemas.microsoft.com/win/2004/08/events eventman.xsd"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/win/2004/08/events"</span> <span class="na">xmlns:win=</span><span class="s">"http://manifests.microsoft.com/win/2004/08/windows/events"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xmlns:trace=</span><span class="s">"http://schemas.microsoft.com/win/2004/08/events/trace"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;instrumentation&gt;</span>
		<span class="nt">&lt;events&gt;</span>
			<span class="nt">&lt;provider</span> <span class="na">name=</span><span class="s">"WEF-Events"</span> <span class="na">guid=</span><span class="s">"{CB3EB4AA-FEDD-41C4-A7BB-E173045E4DC7}"</span> <span class="na">symbol=</span><span class="s">"WEF_Events"</span> <span class="na">resourceFileName=</span><span class="s">"C:\Windows\System32\WEF_Events.dll"</span> <span class="na">messageFileName=</span><span class="s">"C:\Windows\System32\WEF_Events.dll"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;events&gt;</span>
					<span class="nt">&lt;event</span> <span class="na">symbol=</span><span class="s">"WEF_Event"</span> <span class="na">value=</span><span class="s">"6969"</span> <span class="na">version=</span><span class="s">"0"</span> <span class="na">channel=</span><span class="s">"WEF-Security"</span> <span class="na">template=</span><span class="s">"WEF-Template"</span> <span class="na">keywords=</span><span class="s">"win:AuditSuccess win:AuditFailure "</span> <span class="na">message=</span><span class="s">"$(string.WEF-Events.event.6969.message)"</span><span class="nt">&gt;&lt;/event&gt;</span>
				<span class="nt">&lt;/events&gt;</span>
				<span class="nt">&lt;channels&gt;</span>
					<span class="nt">&lt;channel</span> <span class="na">name=</span><span class="s">"WEF-Security"</span> <span class="na">chid=</span><span class="s">"WEF-Security"</span> <span class="na">symbol=</span><span class="s">"WEF_Security"</span> <span class="na">type=</span><span class="s">"Operational"</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">message=</span><span class="s">"$(string.WEF-Events.channel.WEF_Security.message)"</span><span class="nt">&gt;&lt;/channel&gt;</span>
					<span class="nt">&lt;channel</span> <span class="na">name=</span><span class="s">"WEF-System"</span> <span class="na">chid=</span><span class="s">"WEF-System"</span> <span class="na">symbol=</span><span class="s">"WEF_System"</span> <span class="na">type=</span><span class="s">"Operational"</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">message=</span><span class="s">"$(string.WEF-Events.channel.WEF_System.message)"</span><span class="nt">&gt;&lt;/channel&gt;</span>
					<span class="nt">&lt;channel</span> <span class="na">name=</span><span class="s">"WEF-PowerShell"</span> <span class="na">chid=</span><span class="s">"WEF-PowerShell"</span> <span class="na">symbol=</span><span class="s">"WEF_PowerShell"</span> <span class="na">type=</span><span class="s">"Operational"</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">message=</span><span class="s">"$(string.WEF-Events.channel.WEF_PowerShell.message)"</span><span class="nt">&gt;&lt;/channel&gt;</span>
					<span class="nt">&lt;channel</span> <span class="na">name=</span><span class="s">"WEF-Sysmon"</span> <span class="na">chid=</span><span class="s">"WEF-Sysmon"</span> <span class="na">symbol=</span><span class="s">"WEF_Sysmon"</span> <span class="na">type=</span><span class="s">"Operational"</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">message=</span><span class="s">"$(string.WEF-Events.channel.WEF_Sysmon.message)"</span><span class="nt">&gt;&lt;/channel&gt;</span>
				<span class="nt">&lt;/channels&gt;</span>
				<span class="nt">&lt;keywords&gt;&lt;/keywords&gt;</span>
				<span class="nt">&lt;templates&gt;</span>
					<span class="nt">&lt;template</span> <span class="na">tid=</span><span class="s">"WEF-Template"</span><span class="nt">&gt;</span>
						<span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"Unicode"</span> <span class="na">inType=</span><span class="s">"win:UnicodeString"</span> <span class="na">outType=</span><span class="s">"xs:string"</span><span class="nt">&gt;&lt;/data&gt;</span>
						<span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"UInt32"</span> <span class="na">inType=</span><span class="s">"win:UInt32"</span> <span class="na">outType=</span><span class="s">"xs:unsignedInt"</span><span class="nt">&gt;&lt;/data&gt;</span>
					<span class="nt">&lt;/template&gt;</span>
				<span class="nt">&lt;/templates&gt;</span>
			<span class="nt">&lt;/provider&gt;</span>
		<span class="nt">&lt;/events&gt;</span>
	<span class="nt">&lt;/instrumentation&gt;</span>
	<span class="nt">&lt;localization&gt;</span>
		<span class="nt">&lt;resources</span> <span class="na">culture=</span><span class="s">"en-US"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;stringTable&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"keyword.AuditSuccess"</span> <span class="na">value=</span><span class="s">"Audit Success"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"keyword.AuditFailure"</span> <span class="na">value=</span><span class="s">"Audit Failure"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"WEF-Events.event.6969.message"</span> <span class="na">value=</span><span class="s">"$(string.WEF-Events.event.6969.message)"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"WEF-Events.channel.WEF_System.message"</span> <span class="na">value=</span><span class="s">"DC System Logs"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"WEF-Events.channel.WEF_Sysmon.message"</span> <span class="na">value=</span><span class="s">"DC Sysmon Logs"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"WEF-Events.channel.WEF_Security.message"</span> <span class="na">value=</span><span class="s">"DC Security Logs"</span><span class="nt">&gt;&lt;/string&gt;</span>
				<span class="nt">&lt;string</span> <span class="na">id=</span><span class="s">"WEF-Events.channel.WEF_PowerShell.message"</span> <span class="na">value=</span><span class="s">"DC PowerShell Logs"</span><span class="nt">&gt;&lt;/string&gt;</span>
			<span class="nt">&lt;/stringTable&gt;</span>
		<span class="nt">&lt;/resources&gt;</span>
	<span class="nt">&lt;/localization&gt;</span>
<span class="nt">&lt;/instrumentationManifest&gt;</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
    </ol>
  </li>
  <li>
    <p>Compile the manifest file and generate relevant files (e.g. WEF-Events.dll)</p>

    <ol>
      <li>Press <code class="highlighter-rouge">Win</code> + <code class="highlighter-rouge">R</code> then enter <code class="highlighter-rouge">cmd</code>.</li>
      <li>Navigate to where <code class="highlighter-rouge">WEF_Events.man</code> was saved.</li>
      <li>
        <p>Enter the following commands:</p>

        <ol>
          <li>
            <p><strong>mc.exe</strong> (Message Compiler)</p>

            <pre><code class="language-cmd">"C:\Program Files (x86)\Windows Kits\10\bin\x64\mc.exe" WEF_Events.man
"C:\Program Files (x86)\Windows Kits\10\bin\x64\mc.exe" -css WEF_Events.DummyEvent WEF_Events.man
</code></pre>
            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li>The compiler generates the message resource files to which your application links.</li>
              <li>
                <p>Switches used:</p>

                <table>
                  <thead>
                    <tr>
                      <th>OPTION</th>
                      <th>DESCRIPTION</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>-css &lt;namespace&gt;</td>
                      <td>&lt;ul&gt;&lt;li&gt;Generates a <strong>static</strong> C# class&lt;/li&gt;&lt;li&gt;It includes the methods that you would call to log the events defined in your manifest&lt;/li&gt;&lt;/ul&gt;</td>
                    </tr>
                  </tbody>
                </table>
              </li>
              <li>
                <p>File(s) generated after execution:</p>

                <ul>
                  <li>MSG00001.bin</li>
                  <li>WEF_Events.cs</li>
                  <li>WEF_Events.h</li>
                  <li>WEF_Events.rc</li>
                  <li>WEF_EventsTEMP.bin</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <p><strong>rc.exe</strong> (Resource Compiler)</p>

            <pre><code class="language-cmd">"C:\Program Files (x86)\Windows Kits\10\bin\x64\rc.exe" WEF_Events.rc
         
# Microsoft (R) Windows (R) Resource Compiler Version 10.0.10011.16384
# Copyright (C) Microsoft Corporation.  All rights reserved.
</code></pre>
            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li><code class="highlighter-rouge">rc.exe</code> compiles an application’s resources and could be used to build Windows-based applications.</li>
              <li>
                <p>File(s) generated after execution:</p>

                <ul>
                  <li>WEF_Events.res</li>
                </ul>
              </li>
            </ul>
          </li>
          <li>
            <p><strong>csc.exe</strong> (C# Compiler)</p>
            <pre><code class="language-cmd">"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe" /win32res:WEF_Events.res /unsafe /target:library /out:WEF_Events.dll WEF_Events.cs
</code></pre>
            <p><strong>NOTE(S)</strong>:</p>
            <ul>
              <li>No output means the command was successfully executed</li>
              <li>
                <p>Switches used:</p>

                <table>
                  <thead>
                    <tr>
                      <th>OPTION</th>
                      <th>DESCRIPTION</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>/win32res:&lt;file&gt;</td>
                      <td>Specify a Win32 resource file (.res)</td>
                    </tr>
                    <tr>
                      <td>/unsafe</td>
                      <td>Allow ‘unsafe’ code</td>
                    </tr>
                    <tr>
                      <td>/target:library</td>
                      <td>Build a library (Short form: /t:library)</td>
                    </tr>
                    <tr>
                      <td>/out:&lt;file&gt;</td>
                      <td>Specify output file name (default: base name of file with main class or first file)</td>
                    </tr>
                  </tbody>
                </table>
              </li>
              <li>
                <p>File(s) generated after execution:</p>

                <ul>
                  <li>WEF_Events.dll</li>
                </ul>
              </li>
            </ul>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p>Install the <strong>manifest file</strong> with the matching <strong>dll file</strong>:</p>

    <ol>
      <li>
        <p>Move both files to the <code class="highlighter-rouge">C:\Windows\System32</code> directory:</p>

        <pre><code class="language-cmd">copy .\WEF_Events.man C:\Windows\System32\WEF_Events.man
copy .\WEF_Events.dll C:\Windows\System32\WEF_Events.dll
</code></pre>
      </li>
      <li>
        <p>Install the manifest file using <code class="highlighter-rouge">wevtutil</code>:</p>

        <pre><code class="language-cmd">wevtutil im C:\Windows\System32\WEF_Events.man
</code></pre>
      </li>
    </ol>
  </li>
  <li>
    <p>The created logs should appear under <code class="highlighter-rouge">Applications and Services Logs</code> inside <strong>Event Viewer</strong></p>

    <p><strong>NOTE(S)</strong>:</p>
    <ul>
      <li>The logs generated could be used for created subscriptions.</li>
      <li>Additional columns could be added/removed from the logs (e.g. <code class="highlighter-rouge">Log</code>, <code class="highlighter-rouge">Computer</code>)</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="references">REFERENCES</h2>

<ul>
  <li>https://blogs.technet.microsoft.com/russellt/2016/05/18/creating-custom-windows-event-forwarding-logs/</li>
  <li>https://stackoverflow.com/questions/53028775/cannot-locate-ecmangen</li>
  <li>https://developer.microsoft.com/en-us/windows/downloads/sdk-archive</li>
  <li>https://blogs.msdn.microsoft.com/astebner/2007/03/14/mailbag-what-version-of-the-net-framework-is-included-in-what-version-of-the-os/</li>
  <li>https://docs.microsoft.com/en-us/windows/win32/wes/message-compiler–mc-exe-</li>
  <li>https://docs.microsoft.com/en-us/windows/win32/menurc/using-rc-the-rc-command-line-</li>
</ul>
</section>
       </div>
    </div>

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'true', 'auto');
        ga('send', 'pageview');
      </script>
    
  </body>
</html>
